{"version":3,"sources":["/source/gchart_renderers.coffee"],"names":[],"mappings":"CAAA,WAAA,GAAA,IAAA,EAAiB,SAAC,GACd,MAAqB,gBAAX,UAAyC,gBAAV,QACrC,EAAY,QAAQ,WACC,kBAAV,SAAyB,OAAO,IAC3C,QAAQ,UAAW,GAGnB,EAAY,UAEL,SAAC,GAEZ,GAAA,SAAA,GAAkB,SAAC,EAAW,SAAiB,UAAC,EAAW,GACvD,GAAA,GAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,CAiBA,KAjBA,GACI,eACI,GAAI,KACJ,GAAI,OAEZ,EAAO,EAAE,OAAO,EAAU,GAE1B,EAAU,EAAU,aACiB,IAAlB,EAAQ,QAA3B,EAAQ,SACR,EAAU,EAAU,aACiB,IAAlB,EAAQ,QAA3B,EAAQ,SAER,EAAA,yBAAW,KAAA,EAAA,EAAA,EAAA,EAAA,OAAA,EAAA,EAAA,kBAAA,EAAE,KAAK,kBAClB,EAAQ,QAAQ,IAEhB,EAAkB,EAClB,GAAa,GACb,EAAA,EAAA,EAAA,EAAA,OAAA,EAAA,EAAA,IAAA,CAGI,WAFA,GAAO,EAAO,KAAK,MACnB,GAAmB,EAAI,GAAG,OAC1B,EAAA,EAAA,EAAA,EAAA,OAAA,EAAA,EAAA,WACI,EAAM,EAAU,cAAc,EAAQ,GAElC,EAAI,KADL,MAAA,EAAA,QACU,EAAI,QACH,KAClB,GAAU,KAAK,GAEnB,EAAQ,EAAa,EAAU,gBACxB,EAAU,SAAS,OAAY,IAAI,EAAU,SAAS,KAAK,MAAM,IAAQ,IAChF,EAAa,EAAU,SAAS,KAAK,KAC+B,KAAd,IAAtD,GAAS,IAAI,EAAK,cAAc,GAAG,IAAG,GACtC,EAAe,EAAU,SAAS,KAAK,KACiC,KAAhB,IAAxD,GAAS,IAAI,EAAK,cAAc,GAAG,IAAG,GAEtC,GACI,MAAO,EAAE,QAAQ,QAAU,IAC3B,OAAQ,EAAE,QAAQ,SAAW,IAC7B,MAAO,EACP,OAAQ,MAAO,EAAY,YAAa,EAAkB,IAC1D,OAAQ,MAAO,IAEO,IAAvB,EAAU,GAAG,QAAoC,KAApB,EAAU,GAAG,KACzC,EAAQ,QAAS,SAAU,QAE/B,KAAA,IAAA,UAAA,EAAQ,GAAK,CAYb,OAVA,GAAY,OAAO,cAAc,iBAAiB,GAElD,EAAS,EAAE,SAAS,KAAI,MAAO,OAAQ,OAAQ,SAC/C,EAAc,GAAA,QAAO,cAAc,cAAc,UAAA,EAAW,UAAA,EAAW,QAAA,IACvE,EAAQ,KAAK,EAAO,IACpB,EAAO,KAAK,WAAY,WACpB,GAAA,SAAA,GAAa,GAAA,QAAO,cAAc,YAClC,OAAO,cAAc,OAAO,YAAY,EAAQ,KAAM,iBAClD,GAAO,kBAAkB,KAAK,EAAO,MACzC,EAAO,WAAW,KACf,IAEX,EAAE,eAAe,kBACb,aAAc,EAAgB,aAC9B,YAAa,EAAgB,eAC7B,oBAAqB,EAAgB,eAAe,WAAW,IAC/D,aAAc,EAAgB,aAAa,WAAW","file":"gchart_renderers.min.js","sourcesContent":["callWithJQuery = (pivotModule) ->\r\n    if typeof exports is \"object\" and typeof module is \"object\" # CommonJS\r\n        pivotModule require(\"jquery\")\r\n    else if typeof define is \"function\" and define.amd # AMD\r\n        define [\"jquery\"], pivotModule\r\n    # Plain browser env\r\n    else\r\n        pivotModule jQuery\r\n        \r\ncallWithJQuery ($) ->\r\n\r\n    makeGoogleChart = (chartType, extraOptions) -> (pivotData, opts) ->\r\n        defaults =\r\n            localeStrings:\r\n                vs: \"vs\"\r\n                by: \"by\"\r\n\r\n        opts = $.extend defaults, opts\r\n\r\n        rowKeys = pivotData.getRowKeys()\r\n        rowKeys.push [] if rowKeys.length == 0\r\n        colKeys = pivotData.getColKeys()\r\n        colKeys.push [] if colKeys.length == 0\r\n\r\n        headers = (h.join(\"-\") for h in rowKeys)\r\n        headers.unshift \"\"\r\n\r\n        numCharsInHAxis = 0\r\n        dataArray = [headers]\r\n        for colKey in colKeys\r\n            row = [colKey.join(\"-\")]\r\n            numCharsInHAxis += row[0].length\r\n            for rowKey in rowKeys\r\n                agg = pivotData.getAggregator(rowKey, colKey)\r\n                if agg.value()?\r\n                    row.push agg.value()\r\n                else row.push null\r\n            dataArray.push row\r\n\r\n        title = vAxisTitle = pivotData.aggregatorName+ \r\n            if pivotData.valAttrs.length then \"(#{pivotData.valAttrs.join(\", \")})\" else \"\"\r\n        hAxisTitle = pivotData.colAttrs.join(\"-\")\r\n        title += \" #{opts.localeStrings.vs} #{hAxisTitle}\" if hAxisTitle != \"\"\r\n        groupByTitle = pivotData.rowAttrs.join(\"-\")\r\n        title += \" #{opts.localeStrings.by} #{groupByTitle}\" if groupByTitle != \"\"\r\n\r\n        options = \r\n            width: $(window).width() / 1.4\r\n            height: $(window).height() / 1.4\r\n            title: title\r\n            hAxis: {title: hAxisTitle, slantedText: numCharsInHAxis > 50}\r\n            vAxis: {title: vAxisTitle}\r\n\r\n        if dataArray[0].length == 2 and dataArray[0][1] ==  \"\"\r\n            options.legend = position: \"none\"\r\n\r\n        options[k] = v for k, v of extraOptions\r\n\r\n        dataTable = google.visualization.arrayToDataTable(dataArray)\r\n\r\n        result = $(\"<div>\").css(width: \"100%\", height: \"100%\")\r\n        wrapper = new google.visualization.ChartWrapper {dataTable, chartType, options}\r\n        wrapper.draw(result[0])    \r\n        result.bind \"dblclick\", -> \r\n            editor = new google.visualization.ChartEditor()\r\n            google.visualization.events.addListener editor, 'ok', -> \r\n                editor.getChartWrapper().draw(result[0])\r\n            editor.openDialog(wrapper)\r\n        return result\r\n\r\n    $.pivotUtilities.gchart_renderers = \r\n        \"Line Chart\": makeGoogleChart(\"LineChart\")\r\n        \"Bar Chart\": makeGoogleChart(\"ColumnChart\")\r\n        \"Stacked Bar Chart\": makeGoogleChart(\"ColumnChart\", isStacked: true)\r\n        \"Area Chart\": makeGoogleChart(\"AreaChart\", isStacked: true)\r\n"],"sourceRoot":"/source/"}